<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Recurrent Events Regression Based on Counts and Rate Function — rateReg • reda</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Recurrent Events Regression Based on Counts and Rate Function — rateReg" />
<meta property="og:description" content="This function fits recurrent event data (event counts) by gamma frailty
model with spline rate function. The default model is the gamma frailty
model with one piece constant baseline rate function, which is equivalent to
negative binomial regression with the same shape and rate parameter in the
gamma prior. Spline (including piecewise constant) baseline hazard rate
function can be specified for the model fitting." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/reda-Recur.html">Introduction to Formula Response Function Recur()</a>
    </li>
    <li>
      <a href="../articles/reda-intro.html">Introduction to reda through Examples</a>
    </li>
    <li>
      <a href="../articles/reda-simulate.html">Simulate Survival and Recurrent Event Data with reda</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/wenjie2wang/reda/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Recurrent Events Regression Based on Counts and Rate Function</h1>
    <small class="dont-index">Source: <a href='https://github.com/wenjie2wang/reda/blob/master/R/rateReg.R'><code>R/rateReg.R</code></a></small>
    <div class="hidden name"><code>rateReg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function fits recurrent event data (event counts) by gamma frailty
model with spline rate function. The default model is the gamma frailty
model with one piece constant baseline rate function, which is equivalent to
negative binomial regression with the same shape and rate parameter in the
gamma prior. Spline (including piecewise constant) baseline hazard rate
function can be specified for the model fitting.</p>
    </div>

    <pre class="usage"><span class='fu'>rateReg</span>(
  <span class='no'>formula</span>,
  <span class='no'>data</span>,
  <span class='no'>subset</span>,
  <span class='kw'>df</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>knots</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>degree</span> <span class='kw'>=</span> <span class='fl'>0L</span>,
  <span class='no'>na.action</span>,
  <span class='kw'>spline</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"bSplines"</span>, <span class='st'>"mSplines"</span>),
  <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p><code>Recur</code> object produced by function <code><a href='Recur.html'>Recur</a></code>.
The terminal events and risk-free episodes specified in <code>Recur</code>
will be ignored since the model does not support them.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>An optional data frame, list or environment containing the
variables in the model.  If not found in data, the variables are taken
from <code><a href='https://rdrr.io/r/base/environment.html'>environment(formula)</a></code>, usually the environment from which
function <code>rateReg</code> is called.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>An optional vector specifying a subset of observations to be
used in the fitting process.</p></td>
    </tr>
    <tr>
      <th>df</th>
      <td><p>An optional nonnegative integer to specify the degree of freedom
of baseline rate function. If argument <code>knots</code> or <code>degree</code> are
specified, <code>df</code> will be neglected whether it is specified or not.</p></td>
    </tr>
    <tr>
      <th>knots</th>
      <td><p>An optional numeric vector that represents all the internal
knots of baseline rate function.  The default is <code>NULL</code>,
representing no any internal knots.</p></td>
    </tr>
    <tr>
      <th>degree</th>
      <td><p>An optional nonnegative integer to specify the degree of
spline bases.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>A function that indicates what should the procedure do if
the data contains <code>NA</code>s.  The default is set by the na.action
setting of <code>options</code>.  The "factory-fresh" default is
<code>na.omit</code>.  Other possible values inlcude
<code>na.fail</code>, <code>na.exclude</code>, and
<code>na.pass</code>.  <code><a href='https://rdrr.io/r/stats/na.fail.html'>help(na.fail)</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>spline</th>
      <td><p>An optional character that specifies the flavor of splines.
The possible option is <code>bSplines</code> for B-splines or <code>mSplines</code>
for M-splines.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>An optional list of starting values for the parameters to be
estimated in the model.  See more in Section details.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>An optional list of parameters to control the maximization
process of negative log likelihood function and adjust the baseline rate
function.  See more in Section details.</p></td>
    </tr>
    <tr>
      <th>contrasts</th>
      <td><p>An optional list, whose entries are values (numeric
matrices or character strings naming functions) to be used as
replacement values for the contrasts replacement function and whose
names are the names of columns of data containing factors.  See
<code>contrasts.arg</code> of <code>model.matrix.default</code> for details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments for future usage.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>rateReg</code> object, whose slots include</p><ul>
<li><p><code>call</code>: Function call of <code>rateReg</code>.</p></li>
<li><p><code>formula</code>: Formula used in the model fitting.</p></li>
<li><p><code>nObs</code>: Number of observations.</p></li>
<li><p><code>spline</code>: A list contains</p><ul>
<li><p><code>spline</code>: The name of splines used.</p></li>
<li><p><code>knots</code>: Internal knots specified for the baseline
                rate function.</p></li>
<li><p><code>Boundary.knots</code>: Boundary knots specified for the
                baseline rate function.</p></li>
<li><p><code>degree</code>: Degree of spline bases specified in
                baseline rate function.</p></li>
<li><p><code>df</code>: Degree of freedom of the model specified.</p></li>
</ul></li>
<li><p><code>estimates</code>: Estimated coefficients of covariates and
        baseline rate function, and estimated rate parameter of
        gamma frailty variable.</p></li>
<li><p><code>control</code>: The control list specified for model fitting.</p></li>
<li><p><code>start</code>: The initial guess specified for the parameters
        to be estimated.</p></li>
<li><p><code>na.action</code>: The procedure specified to deal with
        missing values in the covariate.</p></li>
<li><p><code>xlevels</code>: A list that records the levels in
        each factor variable.</p></li>
<li><p><code>contrasts</code>: Contrasts specified and used for each
        factor variable.</p></li>
<li><p><code>convergCode</code>: <code>code</code> returned by function
        <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>, which is an integer indicating why the
        optimization process terminated. <code><a href='https://rdrr.io/r/stats/optim.html'>help(optim)</a></code> for details.</p></li>
<li><p><code>logL</code>: Log likelihood of the fitted model.</p></li>
<li><p><code>fisher</code>: Observed Fisher information matrix.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Function <code><a href='Recur.html'>Recur</a></code> in the formula response by default first checks
the dataset and will report an error if the dataset does not fall into
recurrent event data framework.  Subject's ID will be pinpointed if its
observation violates any checking rule. See <code><a href='Recur.html'>Recur</a></code> for all the
checking rules.</p>
<p>Function <code>rateReg</code> first constructs the design matrix from
the specified arguments: <code>formula</code>, <code>data</code>, <code>subset</code>,
<code>na.action</code> and <code>constrasts</code> before model fitting.
The constructed design matrix will be checked again to
fit the recurrent event data framework
if any observation with missing covariates is removed.</p>
<p>The model fitting process involves minimization of negative log
likelihood function, which calls function <code><a href='https://rdrr.io/r/stats/constrOptim.html'>constrOptim</a></code>
internally. <code><a href='https://rdrr.io/r/stats/constrOptim.html'>help(constrOptim)</a></code> for more details.</p>
<p>The argument <code>start</code> is an optional list
that allows users to specify the initial guess for
the parameter values for the minimization of
negative log likelihood function.
The available numeric vector elements in the list include</p><ul>
<li><p><code>beta</code>: Coefficient(s) of covariates,
        set to be all 0.1 by default.</p></li>
<li><p><code>theta</code>: Parameter in Gamma(theta, 1 / theta) for
        frailty random effect, set to be 0.5 by default.</p></li>
<li><p><code>alpha</code>: Coefficient(s) of baseline rate function,
        set to be all 0.05 by default.</p></li>
</ul><p>The argument <code>control</code> is an optional list
that allows users to control the process of minimization of
negative log likelihood function passed to <code>constrOptim</code>
and specify the boundary knots of baseline rate function.
The available options additional to those that can be passed from
<code>control</code> to <code>constrOptim</code> include</p><ul>
<li><p><code>Boundary.knots</code>: A length-two numeric vector to specify
        the boundary knots for baseline rate funtion. By default,
        the left boundary knot is the smallest origin time and
        the right one takes the largest censoring time from data.</p></li>
<li><p><code>verbose</code>: A optional logical value with default <code>TRUE</code>.
        Set it to be <code>FALSE</code> to supress any possible message
        from this function.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fu, H., Luo, J., &amp; Qu, Y. (2016).
Hypoglycemic events analysis via recurrent time-to-event (HEART) models.
<em>Journal Of Biopharmaceutical Statistics</em>, 26(2), 280--298.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary-rateReg-method.html'>summary,rateReg-method</a></code> for summary of fitted model;
<code><a href='coef-rateReg-method.html'>coef,rateReg-method</a></code> for estimated covariate coefficients;
<code><a href='confint-rateReg-method.html'>confint,rateReg-method</a></code> for confidence interval of
covariate coefficients;
<code><a href='baseRate.html'>baseRate,rateReg-method</a></code> for estimated coefficients of baseline
rate function;
<code><a href='mcf.html'>mcf,rateReg-method</a></code> for estimated MCF from a fitted model;
<code><a href='plot-method.html'>plot,mcf.rateReg-method</a></code> for plotting estimated MCF.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>reda</span>)

<span class='co'>## constant rate function</span>
(<span class='no'>constFit</span> <span class='kw'>&lt;-</span> <span class='fu'>rateReg</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>time</span>, <span class='no'>ID</span>, <span class='no'>event</span>) ~ <span class='no'>group</span> + <span class='no'>x1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>simuDat</span>))</div><div class='output co'>#&gt; Call: 
#&gt; rateReg(formula = Recur(time, ID, event) ~ group + x1, data = simuDat)
#&gt; 
#&gt; Coefficients of covariates: 
#&gt; groupTreat         x1 
#&gt; -0.6072889  0.3257505 
#&gt; 
#&gt; Frailty parameter:  0.5874622 
#&gt; 
#&gt; Boundary knots: 
#&gt; 0, 168
#&gt; 
#&gt; Coefficients of pieces:
#&gt;  B-spline1 
#&gt; 0.03041865 </div><div class='input'>
<span class='co'>## six pieces' piecewise constant rate function</span>
(<span class='no'>piecesFit</span> <span class='kw'>&lt;-</span> <span class='fu'>rateReg</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>time</span>, <span class='no'>ID</span>, <span class='no'>event</span>) ~ <span class='no'>group</span> + <span class='no'>x1</span>,
                      <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>simuDat</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='no'>ID</span> <span class='kw'>%in%</span> <span class='fl'>1</span>:<span class='fl'>50</span>,
                      <span class='kw'>knots</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></span>(<span class='fl'>28</span>, <span class='fl'>140</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>28</span>)))</div><div class='output co'>#&gt; Call: 
#&gt; rateReg(formula = Recur(time, ID, event) ~ group + x1, data = simuDat, 
#&gt;     subset = ID %in% 1:50, knots = seq.int(28, 140, by = 28))
#&gt; 
#&gt; Coefficients of covariates: 
#&gt; groupTreat         x1 
#&gt; -0.8030986  0.3361229 
#&gt; 
#&gt; Frailty parameter:  0.6869743 
#&gt; 
#&gt; Internal knots: 
#&gt; 28, 56, 84, 112, 140
#&gt; 
#&gt; Boundary knots: 
#&gt; 0, 168
#&gt; 
#&gt; Coefficients of pieces:
#&gt;  B-spline1  B-spline2  B-spline3  B-spline4  B-spline5  B-spline6 
#&gt; 0.03698068 0.03698067 0.02521395 0.04159804 0.04252515 0.06264047 </div><div class='input'>
<span class='co'>## fit rate function with cubic spline</span>
(<span class='no'>splineFit</span> <span class='kw'>&lt;-</span> <span class='fu'>rateReg</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>time</span>, <span class='no'>ID</span>, <span class='no'>event</span>) ~ <span class='no'>group</span> + <span class='no'>x1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>simuDat</span>,
                      <span class='kw'>knots</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>56</span>, <span class='fl'>84</span>, <span class='fl'>112</span>), <span class='kw'>degree</span> <span class='kw'>=</span> <span class='fl'>3</span>))</div><div class='output co'>#&gt; Call: 
#&gt; rateReg(formula = Recur(time, ID, event) ~ group + x1, data = simuDat, 
#&gt;     knots = c(56, 84, 112), degree = 3)
#&gt; 
#&gt; Coefficients of covariates: 
#&gt; groupTreat         x1 
#&gt; -0.6357103  0.3061451 
#&gt; 
#&gt; Frailty parameter:  0.5885582 
#&gt; 
#&gt; Internal knots: 
#&gt; 56, 84, 112
#&gt; 
#&gt; Boundary knots: 
#&gt; 0, 168
#&gt; 
#&gt; Coefficients of spline bases:
#&gt;  B-spline1  B-spline2  B-spline3  B-spline4  B-spline5  B-spline6  B-spline7 
#&gt; 0.01871840 0.03902177 0.02619108 0.01875500 0.03723467 0.06003499 0.03301292 </div><div class='input'>
<span class='co'>## more specific summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>constFit</span>)</div><div class='output co'>#&gt; Call: 
#&gt; rateReg(formula = Recur(time, ID, event) ~ group + x1, data = simuDat)
#&gt; 
#&gt; Coefficients of covariates: 
#&gt;                coef exp(coef) se(coef)       z Pr(&gt;|z|)  
#&gt; groupTreat -0.60729   0.54483  0.28518 -2.1295  0.03321 *
#&gt; x1          0.32575   1.38507  0.16640  1.9576  0.05028 .
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Parameter of frailty: 
#&gt;         parameter        se
#&gt; Frailty 0.5874622 0.1101527
#&gt; 
#&gt; Boundary knots:
#&gt; 0, 168
#&gt; 
#&gt; Degree of spline bases: 0 
#&gt; 
#&gt; Coefficients of spline bases:
#&gt;               coef se(coef)
#&gt; B-spline1 0.030419   0.0057
#&gt; 
#&gt; Loglikelihood:  -1676.422 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>piecesFit</span>)</div><div class='output co'>#&gt; Call: 
#&gt; rateReg(formula = Recur(time, ID, event) ~ group + x1, data = simuDat, 
#&gt;     subset = ID %in% 1:50, knots = seq.int(28, 140, by = 28))
#&gt; 
#&gt; Coefficients of covariates: 
#&gt;                coef exp(coef) se(coef)       z Pr(&gt;|z|)  
#&gt; groupTreat -0.80310   0.44794  0.38453 -2.0885  0.03675 *
#&gt; x1          0.33612   1.39951  0.23241  1.4463  0.14810  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Parameter of frailty: 
#&gt;         parameter        se
#&gt; Frailty 0.6869743 0.1736384
#&gt; 
#&gt; Internal knots: 
#&gt; 28, 56, 84, 112, 140
#&gt; 
#&gt; Boundary knots:
#&gt; 0, 168
#&gt; 
#&gt; Degree of spline bases: 0 
#&gt; 
#&gt; Coefficients of spline bases:
#&gt;               coef se(coef)
#&gt; B-spline1 0.036981   0.0099
#&gt; B-spline2 0.036981   0.0099
#&gt; B-spline3 0.025214   0.0072
#&gt; B-spline4 0.041598   0.0111
#&gt; B-spline5 0.042525   0.0116
#&gt; B-spline6 0.062640   0.0175
#&gt; 
#&gt; Loglikelihood:  -989.3347 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>splineFit</span>)</div><div class='output co'>#&gt; Call: 
#&gt; rateReg(formula = Recur(time, ID, event) ~ group + x1, data = simuDat, 
#&gt;     knots = c(56, 84, 112), degree = 3)
#&gt; 
#&gt; Coefficients of covariates: 
#&gt;                coef exp(coef) se(coef)       z Pr(&gt;|z|)  
#&gt; groupTreat -0.63571   0.52956  0.28528 -2.2284  0.02586 *
#&gt; x1          0.30615   1.35818  0.16650  1.8387  0.06595 .
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Parameter of frailty: 
#&gt;         parameter        se
#&gt; Frailty 0.5885582 0.1103326
#&gt; 
#&gt; Internal knots: 
#&gt; 56, 84, 112
#&gt; 
#&gt; Boundary knots:
#&gt; 0, 168
#&gt; 
#&gt; Degree of spline bases: 3 
#&gt; 
#&gt; Coefficients of spline bases:
#&gt;               coef se(coef)
#&gt; B-spline1 0.018718   0.0079
#&gt; B-spline2 0.039022   0.0130
#&gt; B-spline3 0.026191   0.0109
#&gt; B-spline4 0.018755   0.0077
#&gt; B-spline5 0.037235   0.0138
#&gt; B-spline6 0.060035   0.0189
#&gt; B-spline7 0.033013   0.0138
#&gt; 
#&gt; Loglikelihood:  -1663.231 </div><div class='input'>
<span class='co'>## model selection based on AIC or BIC</span>
<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span>(<span class='no'>constFit</span>, <span class='no'>piecesFit</span>, <span class='no'>splineFit</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Models are not all fitted to the same number of observations. Consider</span>
#&gt; <span class='warning'>BIC instead?</span></div><div class='output co'>#&gt;           df      AIC
#&gt; constFit   4 3360.843
#&gt; piecesFit  9 1996.669
#&gt; splineFit 10 3346.462</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>BIC</a></span>(<span class='no'>constFit</span>, <span class='no'>piecesFit</span>, <span class='no'>splineFit</span>)</div><div class='output co'>#&gt;           df      BIC
#&gt; constFit   4 3377.702
#&gt; piecesFit  9 2030.003
#&gt; splineFit 10 3388.608</div><div class='input'>
<span class='co'>## estimated covariate coefficients</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>piecesFit</span>)</div><div class='output co'>#&gt; groupTreat         x1 
#&gt; -0.8030986  0.3361229 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>splineFit</span>)</div><div class='output co'>#&gt; groupTreat         x1 
#&gt; -0.6357103  0.3061451 </div><div class='input'>
<span class='co'>## confidence intervals for covariate coefficients</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(<span class='no'>piecesFit</span>)</div><div class='output co'>#&gt;                  2.5%       97.5%
#&gt; groupTreat -1.5567675 -0.04942976
#&gt; x1         -0.1193827  0.79162861</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(<span class='no'>splineFit</span>, <span class='st'>"x1"</span>, <span class='fl'>0.9</span>)</div><div class='output co'>#&gt;            5%       95%
#&gt; x1 0.03228081 0.5800093</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(<span class='no'>splineFit</span>, <span class='fl'>1</span>, <span class='fl'>0.975</span>)</div><div class='output co'>#&gt;                1.25%      98.75%
#&gt; groupTreat -1.275143 0.003722945</div><div class='input'>
<span class='co'>## estimated baseline rate function</span>
<span class='no'>splinesBase</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='baseRate.html'>baseRate</a></span>(<span class='no'>splineFit</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>splinesBase</span>, <span class='kw'>conf.int</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='rateReg-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## estimated baseline mean cumulative function (MCF) from a fitted model</span>
<span class='no'>piecesMcf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcf.html'>mcf</a></span>(<span class='no'>piecesFit</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>piecesMcf</span>, <span class='kw'>conf.int</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blueviolet"</span>)</div><div class='img'><img src='rateReg-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## estimated MCF for given new data</span>
<span class='no'>newDat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='fl'>2</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Treat"</span>, <span class='st'>"Contr"</span>))
<span class='no'>splineMcf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcf.html'>mcf</a></span>(<span class='no'>splineFit</span>, <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='no'>newDat</span>, <span class='kw'>groupName</span> <span class='kw'>=</span> <span class='st'>"Group"</span>,
                 <span class='kw'>groupLevels</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Treatment"</span>, <span class='st'>"Control"</span>))
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>splineMcf</span>, <span class='kw'>conf.int</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>5</span>))</div><div class='img'><img src='rateReg-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## example of further customization by ggplot2</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>splineMcf</span>) +
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_ribbon</a></span>(<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>time</span>, <span class='kw'>ymin</span> <span class='kw'>=</span> <span class='no'>lower</span>,
                    <span class='kw'>ymax</span> <span class='kw'>=</span> <span class='no'>upper</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>Group</span>),
                <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>splineMcf</span>@<span class='kw'>MCF</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.2</span>) +
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span>(<span class='st'>"Days"</span>)</div><div class='img'><img src='rateReg-4.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wenjie Wang, Haoda Fu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


