<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mean Cumulative Function (MCF) — mcf • reda</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Mean Cumulative Function (MCF) — mcf" />
<meta property="og:description" content="An S4 class generic function that returns the mean cumulative function (MCF)
estimates from a fitted model or returns the nonparametric MCF estimates (by
Nelson-Aalen estimator or Cook-Lawless cumulative sample mean estimator)
from the sample data." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/reda-Recur.html">Introduction to Formula Response Function Recur()</a>
    </li>
    <li>
      <a href="../articles/reda-intro.html">Introduction to reda through Examples</a>
    </li>
    <li>
      <a href="../articles/reda-simulate.html">Simulate Survival and Recurrent Event Data with reda</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/wenjie2wang/reda">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mean Cumulative Function (MCF)</h1>
    <small class="dont-index">Source: <a href='https://github.com/wenjie2wang/reda/blob/master/R/mcf-generic.R'><code>R/mcf-generic.R</code></a>, <a href='https://github.com/wenjie2wang/reda/blob/master/R/mcf-formula.R'><code>R/mcf-formula.R</code></a>, <a href='https://github.com/wenjie2wang/reda/blob/master/R/mcf-rateReg.R'><code>R/mcf-rateReg.R</code></a></small>
    <div class="hidden name"><code>mcf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An S4 class generic function that returns the mean cumulative function (MCF)
estimates from a fitted model or returns the nonparametric MCF estimates (by
Nelson-Aalen estimator or Cook-Lawless cumulative sample mean estimator)
from the sample data.</p>
    </div>

    <pre class="usage"><span class='fu'>mcf</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S4 method for formula</span>
<span class='fu'>mcf</span>(<span class='no'>object</span>, <span class='no'>data</span>, <span class='no'>subset</span>, <span class='no'>na.action</span>,
    <span class='kw'>variance</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"LawlessNadeau"</span>, <span class='st'>"Poisson"</span>, <span class='st'>"bootstrap"</span>, <span class='st'>"CSV"</span>),
    <span class='kw'>logConfInt</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>adjustRiskset</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>,
    <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='no'>...</span>)

<span class='co'># S4 method for rateReg</span>
<span class='fu'>mcf</span>(<span class='no'>object</span>, <span class='no'>newdata</span>, <span class='no'>groupName</span>, <span class='no'>groupLevels</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>,
    <span class='no'>na.action</span>, <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An object used to dispatch a method.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments for future usage.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data frame, list or environment containing the variables in
the model.  If not found in data, the variables are taken from
<code><a href='https://rdrr.io/r/base/environment.html'>environment(formula)</a></code>, usually the environment from which the
function is called.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>An optional vector specifying a subset of observations to be
used in the fitting process.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>A function that indicates what should the procedure do if
the data contains <code>NA</code>s.  The default is set by the na.action
setting of <code><a href='https://rdrr.io/r/base/options.html'>options</a></code>.  The "factory-fresh" default is
<code><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></code>.  Other possible values inlcude
<code><a href='https://rdrr.io/r/stats/na.fail.html'>na.fail</a></code>, <code><a href='https://rdrr.io/r/stats/na.fail.html'>na.exclude</a></code>, and
<code><a href='https://rdrr.io/r/stats/na.fail.html'>na.pass</a></code>.  <code><a href='https://rdrr.io/r/utils/help.html'>help(na.fail)</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>variance</th>
      <td><p>A character specifying the method for variance estimates.
The available options are <code>"LawlessNadeau"</code> (the default) for
Lawless and Nadeau (1995) method, <code>"Poisson"</code> for Poisson process
method, <code>"bootstrap"</code> for bootstrap method, and <code>"CSV"</code> for
variance estimates of the corresponding cumulative sample mean function
(CSM) by the cumulative sample variance method (Cook and Lawless, 2007).
Partial matching on the names is allowed.</p></td>
    </tr>
    <tr>
      <th>logConfInt</th>
      <td><p>A logical value. If <code>FALSE</code> (the default), the
confidence interval are constructed based on the normality of the MCF
estimates. Otherwise, the confidence intervals of given level are
constucted based on the normality of logarithm of the MCF estimates.</p></td>
    </tr>
    <tr>
      <th>adjustRiskset</th>
      <td><p>A logical value indicating whether to adjust the size
of risk-set.  If <code>TRUE</code> by default, the size of risk-set will be
adjusted based on at-risk indicators and Nelson-Aalen estimator will be
returned.  Otherwise, the cumulative sample mean (CSM) function given by
Cook and Lawless (2007) will be returned without adjustment on size of
risk-set.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>An optional numeric value indicating the confidence level
required. The default value is 0.95.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>An optional named list specifying other options.  For
    <code>rateReg</code> object, it can be used to specify the time grid where the
    MCF is estimated. The available named elements are given as follows:</p><ul>
<li><p><code>grid</code>: The time grid where MCF is estimated. A dense
            grid is suggested for further using the plot method.</p></li>
<li><p><code>length.out</code>: The length of grid points. The dafault
            value is 1,000.</p></li>
<li><p><code>from</code>: The starting point of grid. The default value is
            the left boundary knots (for <code>rateReg</code> object).</p></li>
<li><p><code>to</code>: The endpoint of grid. The default value is the
            right boundary knots (for <code>rateReg</code> object).</p></li>
</ul><p>The option <code>length.out</code>, <code>from</code>, <code>to</code> will be ignored if
    <code>grid</code> is specified directly. Otherwise, the grid will be generated
    by function <code><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></code> with specified <code>from</code>,
    <code>to</code> and <code>length.out</code>.</p>
<p>For formula method, the available named elements are given as follows:</p><ul>
<li><p><code>B</code>: The number of bootstrap replicates for using
            bootstrap method for variance estimates of sample MCF estimates.
            The default value is 200.</p></li>
<li><p><code>se.method</code>: The method used for SE estimates for
            bootstrap. The available methods include <code>"sample.se"</code>
            (the default) and <code>"normality"</code>. The former takes the
            sample SE of point estimates from bootstrap samples; The latter
            estimates SE based on interquantile and normality assumption.</p></li>
<li><p><code>ci.method</code>: The method used for confidence interval (CI)
            for bootstrap. The available options include <code>"normality"</code>
            (the default) and <code>"percentile"</code>. The former estimates the
            CI based on SE estimates and normality assumption; The latter
            takes percentiles of the bootstrap estimates.</p></li>
<li><p><code>keep.data</code>: A logical value specifying whether to keep the
            processed data in the output object. If <code>TRUE</code>
            (the default), the processed data will be kept in the output and
            available for later usage. Otherwise, an empty data
            frame object will be returned in the <code>data</code> slot.
            <code>FALSE</code> may be set when the memory consumption is
            of concern and we only need MCF estimates. For example, the
            function <code>mcfDiff</code> and <code>mcfDiff.test</code> will not be
            applicable for the <code>mcf.formula</code> object with an empty
            <code>data</code> slot.</p></li>
<li><p><code>verbose</code>: A logical value. The default value is
            <code>TRUE</code>. If <code>FALSE</code>, possible data checking messages
             (not including warnings or errors) will be suppressed.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>An optional data frame. If specified, the data frame should
have the same column names as the covariate names appearing in the
formula of original fitting.</p></td>
    </tr>
    <tr>
      <th>groupName</th>
      <td><p>An optional length-one charactor vector to specify the name
for grouping each unique row in <code>newdata</code>, such as "gender" for
"male" and "female". The default value is "Group".</p></td>
    </tr>
    <tr>
      <th>groupLevels</th>
      <td><p>An optional charactor vector to specify the levels for
each unique row in <code>newdata</code>, such as "treatment" and "control".
The default values are <code>"Level"</code> followed by a numeric sequence
with length of number of levels.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>mcf.formula</code> or <code>mcf.rateReg</code> object.</p>
<p>A brief description of the slots of a <code>mcf.formula</code> object is given as
follows:</p><ul>
<li><p><code>formula</code>: Model Formula.</p></li>
<li><p><code>data</code>: Processed data based on the model formula or an
        empty data frame if <code>keep.data</code> is set to be <code>FALSE</code>.</p></li>
<li><p><code>MCF</code>: A data frame containing estimates for sample MCF.</p></li>
<li><p><code>origin</code>: Time origins.</p></li>
<li><p><code>multiGroup</code>: A logical value indicating whether MCF
        is estimated for different groups respectively.</p></li>
<li><p><code>logConfInt</code>: A logical value indicating whether the
        variance estimates are based on the normality of logarithm of
        the MCF estimates.</p></li>
<li><p><code>level</code>: Confidence level specified.</p></li>
</ul>

<p>Most slots of a <code>mcf.rateReg</code> object are inherited from the input
<code>rateReg</code> object. A brief description of other slots is given as
follows:</p><ul>
<li><p><code>newdata</code>: Given dataset used to estimate MCF.</p></li>
<li><p><code>MCF</code>: A data frame containing MCF estimates.</p></li>
<li><p><code>level</code>: Confidence level specified.</p></li>
<li><p><code>na.action</code>: The way handling missing values.</p></li>
<li><p><code>control</code>: The control list.</p></li>
<li><p><code>multiGroup</code>: A logical value indicating whether MCF
        is estimated for different groups respectively.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For <code>formula</code> object with <code><a href='Recur.html'>Recur</a></code> object as response, the
covariate specified at the right hand side of the formula should be either
<code>1</code> or any "linear" conbination of categorical variable in the data.
The former computes the overall sample MCF.  The latter computes the sample
MCF for each level of the combination of the categorical variable(s)
specified, respectively.</p>
<p>The MCF estimates are computed on each unique time point of the sample data.
By default, the size of risk set is adjusted over time based on the at-risk
indicators, which results in the Nelson-Aalen nonparametric estimator
(Nelson 2003).  If the size of risk set remains a constant (total number of
processes) over time (specified by <code>adjustRiskset = FALSE</code>), the
cumulative sample mean (CSM) function introduced in Chapter 1 of Cook and
Lawless (2007) will be computed instead.  The point estimate of sample MCF
at each time point does not assume any particular underlying model. The
variance estimates at each time point is computed following the Lawless and
Nadeau method (LawLess and Nadeau 1995), the Poisson process method, or the
bootstrap methods.  The approximate confidence intervals are provided as
well, which are constructed based on the asymptotic normality of the MCF
itself (by default) or the logarithm of MCF.</p>
<p>For <code>rateReg</code> object, <code>mcf</code> estimates the baseline MCF and its
confidence interval at each time grid if argument <code>newdata</code> is not
specified.  Otherwise, <code>mcf</code> estimates MCF and its confidence interval
for the given <code>newdata</code> based on Delta-method.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>mcf,formula-method</code>: Sample MCF from data.</p></li>
<li><p><code>mcf,rateReg-method</code>: Estimated MCF from a fitted model.</p></li>
</ul>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cook, R. J., and Lawless, J. (2007). <em>The statistical analysis of
recurrent events</em>, Springer Science &amp; Business Media.</p>
<p>Lawless, J. F. and Nadeau, C. (1995). Some Simple Robust Methods for the
Analysis of Recurrent Events. <em>Technometrics</em>, 37, 158--168.</p>
<p>Nelson, W. B. (2003). <em>Recurrent Events Data Analysis for Product
Repairs, Disease Recurrences, and Other Applications</em> (Vol. 10). SIAM.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rateReg.html'>rateReg</a></code> for model fitting;
<code><a href='mcfDiff.html'>mcfDiff</a></code> for comparing two-sample MCFs.
<code><a href='plot-method.html'>plot-method</a></code> for plotting MCF.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>reda</span>)

<span class='co'>### sample MCF</span>
<span class='co'>## Example 1. valve-seat data</span>
<span class='co'>## the default variance estimates by Lawless and Nadeau (1995) method</span>
<span class='no'>valveMcf0</span> <span class='kw'>&lt;-</span> <span class='fu'>mcf</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>Days</span>, <span class='no'>ID</span>, <span class='no'>No.</span>) ~ <span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>valveSeats</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>valveMcf0</span>, <span class='kw'>conf.int</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>mark.time</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>addOrigin</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) +
    <span class='kw pkg'>ggplot2</span><span class='kw ns'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span>(<span class='st'>"Days"</span>) + <span class='kw pkg'>ggplot2</span><span class='kw ns'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span>()</div><div class='img'><img src='mcf-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## variance estimates following Poisson process model</span>
<span class='no'>valveMcf1</span> <span class='kw'>&lt;-</span> <span class='fu'>mcf</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>Days</span>, <span class='no'>ID</span>, <span class='no'>No.</span>) ~ <span class='fl'>1</span>,
                 <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>valveSeats</span>, <span class='kw'>variance</span> <span class='kw'>=</span> <span class='st'>"Poisson"</span>)
<span class='co'>## variance estimates by bootstrap method (with 1,000 bootstrap samples)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>valveMcf2</span> <span class='kw'>&lt;-</span> <span class='fu'>mcf</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>Days</span>, <span class='no'>ID</span>, <span class='no'>No.</span>) ~ <span class='fl'>1</span>,
                 <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>valveSeats</span>, <span class='kw'>variance</span> <span class='kw'>=</span> <span class='st'>"bootstrap"</span>,
                 <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>1e3</span>))

<span class='co'>## comparing the variance estimates from different methods</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='no'>ciDat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>valveMcf0</span>@<span class='kw'>MCF</span>, <span class='kw'>Method</span> <span class='kw'>=</span> <span class='st'>"Lawless &amp; Nadeau"</span>),
               <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>valveMcf1</span>@<span class='kw'>MCF</span>, <span class='kw'>Method</span> <span class='kw'>=</span> <span class='st'>"Poisson"</span>),
               <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>valveMcf2</span>@<span class='kw'>MCF</span>, <span class='kw'>Method</span> <span class='kw'>=</span> <span class='st'>"Bootstrap"</span>))
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='no'>ciDat</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>time</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>se</span>)) +
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_step</a></span>(<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>color</span> <span class='kw'>=</span> <span class='no'>Method</span>, <span class='kw'>linetype</span> <span class='kw'>=</span> <span class='no'>Method</span>)) +
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span>(<span class='st'>"Days"</span>) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span>(<span class='st'>"SE estimates"</span>) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span>()</div><div class='img'><img src='mcf-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## comparing the confidence interval estimates from different methods</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='no'>ciDat</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>time</span>)) +
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_step</a></span>(<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>MCF</span>)) +
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_step</a></span>(<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>lower</span>, <span class='kw'>color</span> <span class='kw'>=</span> <span class='no'>Method</span>, <span class='kw'>linetype</span> <span class='kw'>=</span> <span class='no'>Method</span>)) +
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_step</a></span>(<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>upper</span>, <span class='kw'>color</span> <span class='kw'>=</span> <span class='no'>Method</span>, <span class='kw'>linetype</span> <span class='kw'>=</span> <span class='no'>Method</span>)) +
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span>(<span class='st'>"Days"</span>) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span>(<span class='st'>"Confidence intervals"</span>) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span>()</div><div class='img'><img src='mcf-3.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>## Example 2. the simulated data</span>
<span class='no'>simuMcf</span> <span class='kw'>&lt;-</span> <span class='fu'>mcf</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>time</span>, <span class='no'>ID</span>, <span class='no'>event</span>) ~ <span class='no'>group</span> + <span class='no'>gender</span>,
               <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>simuDat</span>, <span class='no'>ID</span> <span class='kw'>%in%</span> <span class='fl'>1</span> : <span class='fl'>50</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>simuMcf</span>, <span class='kw'>conf.int</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>1</span> : <span class='fl'>4</span>,
     <span class='kw'>legendName</span> <span class='kw'>=</span> <span class='st'>"Treatment &amp; Gender"</span>)</div><div class='img'><img src='mcf-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### estimate MCF difference between two groups</span>
<span class='co'>## one sample MCF object of two groups</span>
<span class='no'>mcf0</span> <span class='kw'>&lt;-</span> <span class='fu'>mcf</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>time</span>, <span class='no'>ID</span>, <span class='no'>event</span>) ~ <span class='no'>group</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>simuDat</span>)
<span class='co'>## two-sample pseudo-score tests</span>
<span class='fu'><a href='mcfDiff.html'>mcfDiff.test</a></span>(<span class='no'>mcf0</span>)</div><div class='output co'>#&gt; Two-Sample Pseudo-Score Tests:
#&gt;                 Statistic Variance    Chisq DF Pr(&gt;Chisq)   
#&gt; Constant Weight   52.5855 670.1014   4.1266  1   0.042214 * 
#&gt; Linear Weight     35.7687 158.9869   8.0472  1   0.004557 **
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Variance Estimator: robust </div><div class='input'><span class='co'>## difference estimates over time</span>
<span class='no'>mcf0_diff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcfDiff.html'>mcfDiff</a></span>(<span class='no'>mcf0</span>, <span class='kw'>testVariance</span> <span class='kw'>=</span> <span class='st'>"none"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>mcf0_diff</span>)</div><div class='img'><img src='mcf-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## or explicitly ask for the difference of two sample MCF</span>
<span class='no'>mcf1</span> <span class='kw'>&lt;-</span> <span class='fu'>mcf</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>time</span>, <span class='no'>ID</span>, <span class='no'>event</span>) ~ <span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>simuDat</span>,
            <span class='kw'>subset</span> <span class='kw'>=</span> <span class='no'>group</span> <span class='kw'>%in%</span> <span class='st'>"Contr"</span>)
<span class='no'>mcf2</span> <span class='kw'>&lt;-</span> <span class='fu'>mcf</span>(<span class='fu'><a href='Recur.html'>Recur</a></span>(<span class='no'>time</span>, <span class='no'>ID</span>, <span class='no'>event</span>) ~ <span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>simuDat</span>,
            <span class='kw'>subset</span> <span class='kw'>=</span> <span class='no'>group</span> <span class='kw'>%in%</span> <span class='st'>"Treat"</span>)
<span class='co'>## perform two-sample tests and estimate difference at the same time</span>
<span class='no'>mcf12_diff1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcfDiff.html'>mcfDiff</a></span>(<span class='no'>mcf1</span>, <span class='no'>mcf2</span>)
<span class='no'>mcf12_diff2</span> <span class='kw'>&lt;-</span> <span class='no'>mcf1</span> - <span class='no'>mcf2</span>   <span class='co'># or equivalently using the `-` method</span>
<span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>mcf12_diff1</span>, <span class='no'>mcf12_diff2</span>))
<span class='no'>mcf12_diff1</span></div><div class='output co'>#&gt; Call: 
#&gt; mcfDiff(mcf1 = mcf1, mcf2 = mcf2)
#&gt; 
#&gt; Two-Sample Pseudo-Score Tests:
#&gt;                 Statistic Variance    Chisq DF Pr(&gt;Chisq)   
#&gt; Constant Weight   52.5855 670.1014   4.1266  1   0.042214 * 
#&gt; Linear Weight     35.7687 158.9869   8.0472  1   0.004557 **
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Variance Estimator: robust </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>mcf12_diff1</span>)</div><div class='img'><img src='mcf-6.png' alt='' width='700' height='433' /></div><div class='input'>
### For estimated MCF from a fitted model,
### see examples given in function rateReg.
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#functions">Functions</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wenjie Wang, Haoda Fu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


