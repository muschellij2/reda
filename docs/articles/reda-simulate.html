<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulate Survival and Recurrent Event Data with reda • reda</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulate Survival and Recurrent Event Data with reda">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/reda-Recur.html">Introduction to Formula Response Function Recur()</a>
    </li>
    <li>
      <a href="../articles/reda-intro.html">Introduction to reda through Examples</a>
    </li>
    <li>
      <a href="../articles/reda-simulate.html">Simulate Survival and Recurrent Event Data with reda</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wenjie2wang/reda">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Simulate Survival and Recurrent Event Data with reda</h1>
                        <h4 class="author">Wenjie Wang</h4>
            
            <h4 class="date">2019-11-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wenjie2wang/reda/blob/master/vignettes/reda-simulate.Rmd"><code>vignettes/reda-simulate.Rmd</code></a></small>
      <div class="hidden name"><code>reda-simulate.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we briefly introduce how to simulate survival and recurrent event data from stochastic process point of view with the <strong>reda</strong> package. The core function named <code><a href="../reference/simEvent.html">simEvent()</a></code> provides an intuitive and flexible interface for simulating survival and recurrent event times from one stochastic process. Another function named <code><a href="../reference/simEvent.html">simEventData()</a></code> is simply a wrapper that calls <code><a href="../reference/simEvent.html">simEvent()</a></code> internally and collects the event times and the covariates of a given number of processes into a data frame. Examples of generating random samples from common survival and recurrent models are provided. In fact, the function <code><a href="../reference/simEvent.html">simEvent()</a></code> and <code><a href="../reference/simEvent.html">simEventData()</a></code> may serve as the building blocks for simulating multitype event data including multiple type event data, recurrent events with termination, and competing risk data. The details of function syntax and the objects produced are available in the package manual and thus not covered in this vignette.</p>
<div id="intro" class="section level1">
<h1 class="hasAnchor">
<a href="#intro" class="anchor"></a>Introduction</h1>
<div id="intensity" class="section level2">
<h2 class="hasAnchor">
<a href="#intensity" class="anchor"></a>Intensity function</h2>
<p>We introduce the general form of hazard rate function considered and implemented in the function <code><a href="../reference/simEvent.html">simEvent()</a></code>, which can be generalized to two classes called the relative risk model, and the accelerated failure time model. The introduction is based on Section 2.2 and Section 2.3 of <span class="citation">Kalbfleisch and Prentice (2002)</span>. Other helpful references include <span class="citation">Aalen, Borgan, and Gjessing (2008)</span>, <span class="citation">Kleinbaum and Klein (2011)</span>, among others.</p>
<p>Let’s consider <span class="math inline">\(n\)</span> stochastic processes with the baseline hazard rate function <span class="math inline">\(\rho(t)\)</span> of time <span class="math inline">\(t\)</span>. For the stochastic process <span class="math inline">\(i\)</span>, <span class="math inline">\(i\in\{1,\ldots,n\}\)</span>, let <span class="math inline">\(\mathbf{z}_i=(z_{i1},\ldots,z_{ip})^{\top}\)</span> denote the covariate vector of length <span class="math inline">\(p\)</span>, and <span class="math inline">\(\boldsymbol{\beta}=(\beta_1,\ldots,\beta_p)^{\top}\)</span> denote the covariate coefficients.</p>
<div id="relative-risk-model" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-risk-model" class="anchor"></a>Relative risk model</h3>
<p>Given the covariates <span class="math inline">\(\mathbf{z}_i\)</span> (not including the intercept term), the intensity function of time <span class="math inline">\(t\)</span> for the relative risk regression model can be specified as follows: <span class="math display">\[\lambda(t \mid \mathbf{z}_i) = \rho(t)\,r(\mathbf{z}_i,
\boldsymbol{\beta}),\]</span> where <span class="math inline">\(r(\mathbf{z}_i, \boldsymbol{\beta})\)</span> is the relative risk function. For the Cox model <span class="citation">(Cox 1972)</span> and the Andersen-Gill model <span class="citation">(Andersen and Gill 1982)</span>, <span class="math inline">\(r(\mathbf{z}_i, \boldsymbol{\beta})= \exp\{\boldsymbol{\beta}^{\top}\mathbf{z}_i\}\)</span>. Other common choices include the linear relative risk function: <span class="math inline">\(r(\mathbf{z}_i, \boldsymbol{\beta}) = 1 + \boldsymbol{\beta}^{\top}\mathbf{z}_i\)</span>, and the excess relative risk function: <span class="math inline">\(r(\mathbf{z}_i, \boldsymbol{\beta}) = \prod_{j=1}^p(1 + \beta_j z_{ij})\)</span>, both of which, however, suffer from the drawback that the <span class="math inline">\(r(\mathbf{z}_i, \boldsymbol{\beta})\)</span> is not necessarily positive. Therefore, the coefficient estimates must be restricted to guarantee that the relative risk function is positive for all possible covariates. The restriction disappears for the exponential relative risk function since it always returns positive values.</p>
<p>We may extend the model by considering a random frailty effect <span class="math inline">\(u_i\)</span> (of expectation one) to account for heterogeneity between different processes or processes from different clusters. The intensity function becomes <span class="math display">\[\lambda(t
\mid \mathbf{z}_i, u_i) = u_i\,\rho(t)\,r(\mathbf{z}_i, \boldsymbol{\beta}).\]</span> The common choices for distribution of the random frailty effect include Gamma distribution of mean one, and lognormal distribution of mean zero in logarithm scale.</p>
<p>Furthermore, both covariates and coefficients may be time-varying. So a general form of the intensity function for the relative risk model is given as follows: <span class="math display">\[\lambda\bigl(t \mid \mathbf{z}_i(t), u_i\bigr) =
u_i\,\rho(t)\,r\bigl(\mathbf{z}_i(t), \boldsymbol{\beta}(t)\bigr).\]</span></p>
</div>
<div id="accelerated-failure-time-model" class="section level3">
<h3 class="hasAnchor">
<a href="#accelerated-failure-time-model" class="anchor"></a>Accelerated failure time model</h3>
<p>The relative risk models incorporate the covariates and their coefficients through a relative risk function multiplied by the baseline hazard rate, which provides an intuitive interpretation. However, we may consider a direct relationship between the covraiates <span class="math inline">\(\mathbf{z}\)</span> (including the intercept term) and the time to failure <span class="math inline">\(T&gt;0\)</span>, <span class="math inline">\(\log(T) = \alpha + \sigma W\)</span>, where <span class="math inline">\(W\)</span> is a standardized random error variable with density function <span class="math inline">\(f_W(w)\)</span>, suvival function <span class="math inline">\(S_W(w)\)</span> and hazard function <span class="math inline">\(\rho(w) = f_W(w) / S_W(w)\)</span>, <span class="math inline">\(\sigma\)</span> represents the standard error, and <span class="math inline">\(\alpha = \boldsymbol{\beta}^{\top}\mathbf{z}\)</span>. We assume that <span class="math inline">\(W\)</span> is independent of <span class="math inline">\(\boldsymbol{\beta}\)</span> given the covariates <span class="math inline">\(\mathbf{z}\)</span>. Taking exponentiation gives <span class="math inline">\(T=\exp(\boldsymbol{\beta}^{\top}\mathbf{z})\exp(W)\)</span> with density <span class="math inline">\(f_T(t) = \frac{1}{\sigma t}f_W\bigl((\log(t) - \alpha)/\sigma\bigr)\)</span>, survival function <span class="math inline">\(S_T(t) = S_W\bigl((\log(t) - \alpha)/\sigma\bigr)\)</span>, and hazard function <span class="math display">\[\lambda(t \mid \mathbf{z}_i) = \frac{1}{\sigma t}\rho\bigl((\log(t) -
\alpha)/\sigma\bigr).\]</span> Let <span class="math inline">\(\lambda_{\mathbf{z}}=\exp(- \alpha)\)</span> and <span class="math inline">\(p = 1 / \sigma\)</span>, we may rewrite the hazard function as follows: <span class="math display">\[\lambda(t \mid
\mathbf{z}_i) = \frac{p}{t}\rho\bigl(p\log(\lambda_{\mathbf{z}} t)\bigr).\]</span> The resulting model is called accelerated failure time (AFT) model.</p>
<p>For example, suppose <span class="math inline">\(W\)</span> follows standard logistic distribution with density <span class="math inline">\(f_W(w) = e^w / (1 + e^w) ^ 2\)</span>, survival function <span class="math inline">\(S_W(w) = 1 / (1 + e^w)\)</span>, and hazard function <span class="math inline">\(\rho(w) = e^w / (1 + e^w)\)</span>. This leads to log-logistic model of <span class="math inline">\(T\)</span> with hazard function <span class="math display">\[\lambda(t \mid \mathbf{z}_i) = \frac{p
(t\lambda_{\mathbf{z}})^p/t}{1 + (t\lambda_{\mathbf{z}})^p}.\]</span></p>
<p>Similarly, we may further consider frailty factor, time-variant covariates, and time-varying covariate coefficients. So a general form of the intensity function may be given as follows: <span class="math display">\[\lambda\bigl(t \mid \mathbf{z}_i(t), u_i\bigr) =
\frac{u_i\,p}{t}\,\rho\bigl( p \log(t) -
p \boldsymbol{\beta}(t)^{\top}\mathbf{z}_i(t)\bigr).\]</span></p>
</div>
<div id="intensity-function-in-general-form" class="section level3">
<h3 class="hasAnchor">
<a href="#intensity-function-in-general-form" class="anchor"></a>Intensity function in general form</h3>
<p>The function <code><a href="../reference/simEvent.html">simEvent()</a></code> and <code><a href="../reference/simEvent.html">simEventData()</a></code> allow users to specify an intensity function in an even more general form given below. <span class="math display">\[\lambda\bigl(t \mid
\mathbf{z}_i(t), u_i\bigr) = u_i\,\rho\bigl(t, \mathbf{z}_i(t),
\boldsymbol{\beta}(t)\bigr) \,r\bigl(\mathbf{z}_i(t),
\boldsymbol{\beta}(t)\bigr),\]</span> where <span class="math inline">\(u_i\)</span>, <span class="math inline">\(\rho(\cdot)\)</span>, and <span class="math inline">\(r(\cdot)\)</span> corresponds to the argument <code>frailty</code>, <code>rho</code>, and <code>relativeRisk</code>, respectively.</p>
</div>
</div>
<div id="sampling-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#sampling-methods" class="anchor"></a>Sampling methods</h2>
<p>The thinning method <span class="citation">(Lewis and Shedler 1979)</span> and the inversion method <span class="citation">(Çınlar 1975)</span> are implemented for sampling event times. It can be shown that both methods achieve the given hazard rate. For function <code><a href="../reference/simEvent.html">simEvent()</a></code>, the thinning method is the default method when the hazard rate function is bounded within follow-ups. Otherwise, the inversion method will be used. We may specify the sampling method via the argument <code>method</code> in function <code><a href="../reference/simEvent.html">simEvent()</a></code> and <code><a href="../reference/simEvent.html">simEventData()</a></code>.</p>
</div>
</div>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(reda)                    <span class="co"># attach reda package to the search path</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span>(<span class="st">"reda"</span>)           <span class="co"># check the package version</span></span></code></pre></div>
<pre><code>## [1] '0.5.0'</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">digits =</span> <span class="dv">3</span>)              <span class="co"># set the number of significant digits to print</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)                    <span class="co"># set random number seed</span></span></code></pre></div>
</div>
<div id="poisson-process" class="section level1">
<h1 class="hasAnchor">
<a href="#poisson-process" class="anchor"></a>Poisson process</h1>
<div id="hpp" class="section level2">
<h2 class="hasAnchor">
<a href="#hpp" class="anchor"></a>Homogeneous Poisson process</h2>
<p>A homogeneous/stationary Poisson process (HPP) has a constant hazard rate over time with the interarrival times (between two successive arrivals/events) following exponential distribution. Two simple examples of simulating a homogeneous Poisson process using <code><a href="../reference/simEvent.html">simEvent()</a></code> are given as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">## HPP from time 1 to 5 of intensity 1 without covariates</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">rho =</span> <span class="dv">1</span>, <span class="dt">origin =</span> <span class="dv">1</span>, <span class="dt">endTime =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## 'simEvent' S4 class object:
## [1] 1.84 2.42 3.75 3.78 3.84 4.15 4.47 4.61</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">## HPP from 0 to 10 of baseline hazard rate 0.5 with two covariates</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>), <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>), <span class="dt">rho =</span> <span class="fl">0.5</span>, <span class="dt">endTime =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## 'simEvent' S4 class object:
## [1] 0.717 1.076 2.692 5.666 6.577 7.701</code></pre>
<p>The function <code><a href="../reference/simEvent.html">simEventData()</a></code> enable us to simulate multiple processes and collect the simulated event times into a survival or recurrent event data format.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">## recurrent events from two processes with same covariates</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dv">2</span>, <span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>), <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">rho =</span> <span class="fl">0.5</span>, <span class="dt">endTime =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##   ID time event origin X.1 X.2
## 1  1 3.38     1      0 0.2 0.5
## 2  1 5.00     0      0 0.2 0.5
## 3  2 1.84     1      0 0.2 0.5
## 4  2 5.00     0      0 0.2 0.5</code></pre>
<p>In the example given above, the number of process is explicitly specified to be two. However, if it is not specified, it will be the number of rows of the covariate matrix. See the example given below.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">## recurrent events from two processes</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">## with different time-invariant covariates and time origins</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">2</span>), <span class="fl">0.5</span>), <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>),</span>
<span id="cb10-4"><a href="#cb10-4"></a>             <span class="dt">rho =</span> <span class="fl">0.2</span>, <span class="dt">origin =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">endTime =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">10</span>, <span class="dv">9</span>))</span></code></pre></div>
<pre><code>##   ID  time event origin   X.1 X.2
## 1  1  4.91     1      1 0.838 0.5
## 2  1  6.31     1      1 0.838 0.5
## 3  1  7.04     1      1 0.838 0.5
## 4  1 10.00     0      1 0.838 0.5
## 5  2  3.44     1      0 0.153 0.5
## 6  2  6.68     1      0 0.153 0.5
## 7  2  9.00     0      0 0.153 0.5</code></pre>
<p>We can also simulate survival data by taking the first event of each process. Setting <code>recurrent = FALSE</code> in function <code><a href="../reference/simEvent.html">simEvent()</a></code> (or function <code><a href="../reference/simEvent.html">simEventData()</a></code>) gives us the survival time(s) or the right censoring time(s). In the example given below, we specified <code>endTime = "rnorm"</code> and <code>arguments = list(endTime = list(mean = 10))</code> for generating a random censoring times from normal distribution with mean ten and unit standard deviation. Also note that the specified <code>origin</code> is recycled for these ten processes.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">## survival data by set 'recurrent = FALSE'</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">10</span>), <span class="dv">1</span>), <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">rho =</span> <span class="fl">0.1</span>,</span>
<span id="cb12-3"><a href="#cb12-3"></a>             <span class="dt">origin =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">endTime =</span> stats<span class="op">::</span>rnorm, <span class="dt">recurrent =</span> <span class="ot">FALSE</span>,</span>
<span id="cb12-4"><a href="#cb12-4"></a>             <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">endTime =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">mean =</span> <span class="dv">10</span>)))</span></code></pre></div>
<pre><code>##    ID  time event origin    X.1 X.2
## 1   1  9.11     0      0 -0.772   1
## 2   2 10.38     0      1  0.287   1
## 3   3  4.55     1      0 -1.221   1
## 4   4 10.39     0      1  0.435   1
## 5   5  9.55     1      0  0.800   1
## 6   6  8.97     0      1 -0.164   1
## 7   7  8.25     1      0  1.243   1
## 8   8 10.96     0      1 -0.934   1
## 9   9 10.08     0      0  0.394   1
## 10 10 11.13     0      1  0.404   1</code></pre>
</div>
<div id="nhpp" class="section level2">
<h2 class="hasAnchor">
<a href="#nhpp" class="anchor"></a>Nonhomogeneous Poisson process</h2>
<p>In contrast to HPP, a nonhomogeneous Poisson process (NHPP) has a time-varying hazard rate function. In that case, we may specify the baseline hazard rate function <code>rhoFun()</code> to be a function object whose first argument represents the time variable. A quick example is given below, where the baseline hazard rate function <span class="math inline">\(\rho(t) = \sin(t) + 1\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>rhoFun &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">b =</span> <span class="dv">1</span>) (<span class="kw"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(x) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>b</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">rho =</span> rhoFun)</span></code></pre></div>
<pre><code>## 'simEvent' S4 class object:
## [1] 1.15</code></pre>
<p>As demonstrated in the last example for HPP, other possible arguments of the function objects can be specified via the <code>arguments</code>. For example, that <code>arguments = list(rho = list(b = 0.5))</code> specifies the baseline hazard rate function to be <span class="math inline">\(\rho(t) = 0.5(\sin(t) + 1)\)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span>(<span class="dv">2</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>)), <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>),</span>
<span id="cb16-2"><a href="#cb16-2"></a>             <span class="dt">rho =</span> rhoFun, <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">rho =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">b =</span> <span class="fl">0.5</span>)))</span></code></pre></div>
<pre><code>##   ID  time event origin    X.1 X.2
## 1  1 3.000     0      0 0.0687   0
## 2  2 0.715     1      0 0.5692   1
## 3  2 1.120     1      0 0.5692   1
## 4  2 2.208     1      0 0.5692   1
## 5  2 3.000     0      0 0.5692   1</code></pre>
</div>
</div>
<div id="renewal-processes" class="section level1">
<h1 class="hasAnchor">
<a href="#renewal-processes" class="anchor"></a>Renewal processes</h1>
<p>In the Poisson process, the interarrival times between two successive arrivals (or events) follow exponential distribution independently. We may generalize the distribution of interarrival times and consider more general renewal processes.</p>
<p>In function <code><a href="../reference/simEvent.html">simEvent()</a></code> (and <code><a href="../reference/simEvent.html">simEventData()</a></code>), we may specify the distribution of the interarrival times via the argument <code>interarrival</code>, which takes the function <code><a href="https://rdrr.io/r/stats/Exponential.html">stats::rexp()</a></code> for generating interarrival times following exponential distribution by default. In general, the argument <code>interarrival</code> takes a function with at least one argument named <code>rate</code> for generating random (nonnegative) interarrival times from a certain distribution at the given arrival rate. A quick example of generating the interarrival times following Gamma distribution of scale one is given as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">interarrival =</span> <span class="cf">function</span>(n, rate) <span class="kw"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span>(n, <span class="dt">shape =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>rate))</span></code></pre></div>
<pre><code>## 'simEvent' S4 class object:
## [1] 0.182 1.878</code></pre>
<p>If the specified function has an argument named <code>n</code>, the function <code><a href="../reference/simEvent.html">simEvent()</a></code> will assume that the function can generate <code>n</code> number of random interarrival times at one time and take advantage of the vectorization for a potentially better performance. However, it is optional. The example given below produces an equivalent result.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">interarrival =</span> <span class="cf">function</span>(rate) <span class="kw"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">shape =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>rate))</span></code></pre></div>
<pre><code>## 'simEvent' S4 class object:
## [1] 0.182 1.878</code></pre>
</div>
<div id="beyond-time-invariance" class="section level1">
<h1 class="hasAnchor">
<a href="#beyond-time-invariance" class="anchor"></a>Beyond time-invariance</h1>
<div id="time-variant-covariates" class="section level2">
<h2 class="hasAnchor">
<a href="#time-variant-covariates" class="anchor"></a>Time-variant covariates</h2>
<p>In practice, some covariates such as patients’ age, automobile’s mileage may vary over time. The argument <code>z</code> in the function <code><a href="../reference/simEvent.html">simEvent()</a></code> and <code><a href="../reference/simEvent.html">simEventData()</a></code> may take a function of time that returns a vector of covariates for generating event times with the time-varying covariates. Let’s consider an example of generating recurrent event times with three covariates, where two of which are time-variant.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>zFun1 &lt;-<span class="st"> </span><span class="cf">function</span>(time) <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(time <span class="op">/</span><span class="st"> </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(time <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>), <span class="fl">0.5</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>))</span></code></pre></div>
<pre><code>##   ID  time event origin  X.1 X.2 X.3
## 1  1 0.971     1      0 1.10   0 0.5
## 2  1 1.880     1      0 1.19   1 0.5
## 3  1 1.902     1      0 1.19   1 0.5
## 4  1 1.940     1      0 1.19   1 0.5
## 5  1 2.156     1      0 1.22   1 0.5
## 6  1 2.371     1      0 1.24   1 0.5
## 7  1 2.471     1      0 1.25   1 0.5
## 8  1 3.000     0      0 1.30   1 0.5</code></pre>
<p>In the example given above, the covariate vector is <span class="math inline">\(\mathbf{z}(t)=(0.1t+1, \boldsymbol{1}(t &gt; 1), 0.5)^{\top}\)</span>. If the covariate function has more arguments, we may specify them by a named list in <code>arguments</code>. The example given below produces the equivalent results.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>zFun2 &lt;-<span class="st"> </span><span class="cf">function</span>(x, a, b) <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(x <span class="op">/</span><span class="st"> </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span>a, <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(x <span class="op">&gt;</span><span class="st"> </span>b), <span class="fl">0.5</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> zFun2, <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>),</span>
<span id="cb24-4"><a href="#cb24-4"></a>             <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##   ID  time event origin  X.1 X.2 X.3
## 1  1 0.971     1      0 1.10   0 0.5
## 2  1 1.880     1      0 1.19   1 0.5
## 3  1 1.902     1      0 1.19   1 0.5
## 4  1 1.940     1      0 1.19   1 0.5
## 5  1 2.156     1      0 1.22   1 0.5
## 6  1 2.371     1      0 1.24   1 0.5
## 7  1 2.471     1      0 1.25   1 0.5
## 8  1 3.000     0      0 1.30   1 0.5</code></pre>
<p>Notice that in the examples given above, if we generate event times for more than one process, the time-varying covariate function will remain the same for different processes, which may not be the case in practice. A more realistic situation is that the time-variant covariate functions are different among different processes but coming from a common function family. Let’s consider the Stanford heart transplant data <span class="citation">(Crowley and Hu 1977)</span> as an example (the <code>heart</code> data available in the <strong>survival</strong> package). The covariate <code>transplant</code> indicating whether the patient has already received a heart transplant before time <code>t</code> is time-dependent and can be represented by a indicator function family, <span class="math inline">\(\boldsymbol{1}(t &gt; b)\)</span>, where <span class="math inline">\(b\)</span> is a known parameter that may differ among patients. For a particular patient <span class="math inline">\(i\)</span>, <span class="math inline">\(b = b_i\)</span> is a known constant. In that case, we specify the function parameters inside the <code>quote</code> function as follows:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>zFun3 &lt;-<span class="st"> </span><span class="cf">function</span>(time, a, b) <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(time <span class="op">/</span><span class="st"> </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span>a, <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(time <span class="op">&gt;</span><span class="st"> </span>b))</span>
<span id="cb26-2"><a href="#cb26-2"></a>(simDat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">nProcess =</span> <span class="dv">3</span>, <span class="dt">z =</span> zFun3, <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>, <span class="fl">0.5</span>),</span>
<span id="cb26-3"><a href="#cb26-3"></a>                        <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">a =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="dv">1</span>, <span class="dv">10</span>) <span class="op">/</span><span class="st"> </span><span class="dv">10</span>),</span>
<span id="cb26-4"><a href="#cb26-4"></a>                                                  <span class="dt">b =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>))))))</span></code></pre></div>
<pre><code>##    ID  time event origin   X.1 X.2
## 1   1 0.104     1      0 1.710   0
## 2   1 0.328     1      0 1.733   0
## 3   1 1.335     1      0 1.833   0
## 4   1 3.000     0      0 2.000   1
## 5   2 0.583     1      0 1.258   0
## 6   2 2.327     1      0 1.433   1
## 7   2 3.000     0      0 1.500   1
## 8   3 0.804     1      0 0.680   0
## 9   3 0.838     1      0 0.684   0
## 10  3 1.472     1      0 0.747   0
## 11  3 3.000     0      0 0.900   1</code></pre>
<p>In the example given above, the covariate <code>X.2</code> is simulated from the indicator function famliy, <span class="math inline">\(\boldsymbol{1}(t &gt; b)\)</span>, where parameter <span class="math inline">\(b\)</span> follows uniform distribution between 1 and 3. Internally, the parameters specified in <code>arguments</code> were evaluated for each process. We may check the values of the parameter <code>a</code> from the generated covariate <code>X.1</code> for different processes as follows:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co">## check the values of parameter `a` for different processes</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(simDat, <span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(ID, <span class="dt">a =</span> X<span class="fl">.1</span> <span class="op">-</span><span class="st"> </span>time <span class="op">/</span><span class="st"> </span><span class="dv">10</span>)))</span></code></pre></div>
<pre><code>##      ID   a
## [1,]  1 1.7
## [2,]  2 1.2
## [3,]  3 0.6
## [4,]  3 0.6</code></pre>
</div>
<div id="time-variant-covariate-coefficients" class="section level2">
<h2 class="hasAnchor">
<a href="#time-variant-covariate-coefficients" class="anchor"></a>Time-variant covariate coefficients</h2>
<p>The assumption of time-invariance on the covariate coefficients can be hard to justify in practice. We may simulate event times with time-varying covariate coefficients by specifying the argument <code>zCoef</code> to be a function of time that returns a vector of coefficients at the input time point. How we may specify the argument <code>zCoef</code> for time-varying coefficients is very similar to the way we may specify the argument <code>z</code> for time-varying covariates introduced in last section. For example, we may generate event times with both covariates and their coefficients being time-variant as follows:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>zCoefFun &lt;-<span class="st"> </span><span class="cf">function</span>(time, shift) <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(time <span class="op">/</span><span class="st"> </span><span class="dv">10</span>), <span class="kw"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(time <span class="op">+</span><span class="st"> </span>shift), <span class="fl">0.1</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> zCoefFun,</span>
<span id="cb30-3"><a href="#cb30-3"></a>             <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">shift =</span> <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##   ID time event origin  X.1 X.2 X.3
## 1  1 1.12     1      0 1.11   1 0.5
## 2  1 1.34     1      0 1.13   1 0.5
## 3  1 2.31     1      0 1.23   1 0.5
## 4  1 2.43     1      0 1.24   1 0.5
## 5  1 3.00     0      0 1.30   1 0.5</code></pre>
<p>As demonstrated in the example given above, we may similarly specify the other arguments of the time-varying coefficient function via a named list in <code>arguments</code>.</p>
</div>
</div>
<div id="frailty" class="section level1">
<h1 class="hasAnchor">
<a href="#frailty" class="anchor"></a>Frailty models</h1>
<div id="individual-frailty" class="section level2">
<h2 class="hasAnchor">
<a href="#individual-frailty" class="anchor"></a>Frailty for individual processes</h2>
<p>Let’s consider frailty factors for individual processes first, where each process <span class="math inline">\(i\)</span> has its own frailty effect <span class="math inline">\(w_i\)</span>. A popular choice of the frailty distribution is the one-parameter gamma distribution of mean one, which often leads to an explicit marginal likelihood in a relatively simple expression. Similar to the argument <code>z</code>, <code>zCoef</code>, and <code>rho</code>, the argument <code>frailty</code> may take a function as input for simulating the frailty effect. For example, we may simulate the recurrent event times for one process with frailty factor following gamma(2, 0.5) via <code>frailty = "rgamma"</code> and <code>arguments = list(frailty = list(shape = 2, scale = 0.5))</code> as follows:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">frailty =</span> stats<span class="op">::</span>rgamma,</span>
<span id="cb32-3"><a href="#cb32-3"></a>             <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">frailty =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> <span class="fl">0.5</span>)))</span></code></pre></div>
<pre><code>##   ID  time event origin  X.1 X.2 X.3
## 1  1 0.135     1      0 1.01   0 0.5
## 2  1 0.620     1      0 1.06   0 0.5
## 3  1 1.102     1      0 1.11   1 0.5
## 4  1 1.324     1      0 1.13   1 0.5
## 5  1 3.000     0      0 1.30   1 0.5</code></pre>
<p>The named list <code><a href="https://rdrr.io/r/base/list.html">list(shape = 2, scale = 0.5)</a></code> was passed to the function <code>rgamma</code> (from the <strong>stats</strong> package). The random number seed was reset so that we might compare the results with the first example of time-variant covariates. Note that it is users’ job to make sure the specified distribution of the frailty factor has mean one (or makes sense in a certain way). The function <code><a href="../reference/simEvent.html">simEvent()</a></code> and <code><a href="../reference/simEvent.html">simEventData()</a></code> only check the sign of the simulated frailty effect. An error will be thrown out if the generated frailty effect is not positive.</p>
<p>To demonstrate how to specify other distribution of the frailty factor, we simulate the recurrent event times for one process by three slightly different but equivalent approaches in the following examples, where the frailty effect follows log-normal distribution of mean one.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="co">## use function `rlnorm` from the stats package</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">frailty =</span> stats<span class="op">::</span>rlnorm,</span>
<span id="cb34-4"><a href="#cb34-4"></a>         <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">frailty =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">sdlog =</span> <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## 'simEvent' S4 class object:
## [1] 1.59 1.63 1.70 2.08 2.45 2.63</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="co">## use a customized function with argument `n` and `sdlog`</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>logNorm1 &lt;-<span class="st"> </span><span class="cf">function</span>(n, sdlog) <span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sdlog))</span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">frailty =</span> logNorm1,</span>
<span id="cb36-5"><a href="#cb36-5"></a>         <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">frailty =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">sdlog =</span> <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## 'simEvent' S4 class object:
## [1] 1.59 1.63 1.70 2.08 2.45 2.63</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="co">## use a customized function with argument `sdlog` only</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>logNorm2 &lt;-<span class="st"> </span><span class="cf">function</span>(sdlog) <span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sdlog))</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">frailty =</span> logNorm2,</span>
<span id="cb38-5"><a href="#cb38-5"></a>         <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">frailty =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">sdlog =</span> <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## 'simEvent' S4 class object:
## [1] 1.59 1.63 1.70 2.08 2.45 2.63</code></pre>
<p>If the function specified for <code>frailty</code> has an argument named <code>n</code>, that <code>n = 1</code> will be specified internally by the function <code><a href="../reference/simEvent.html">simEvent()</a></code>, which is designed for using the functions generating random numbers, such as <code><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma()</a></code> and <code><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm()</a></code> from the <strong>stats</strong> package.</p>
</div>
<div id="shared-frailty" class="section level2">
<h2 class="hasAnchor">
<a href="#shared-frailty" class="anchor"></a>Shared frailty for clusters</h2>
<p>When different processes come from several clusters, we may consider a same frailty effect shared among processes within a cluster. The case we considered in last section where frailty factors are different among individual processes is a special case when the cluster size is one.</p>
<p>In the function <code><a href="../reference/simEvent.html">simEvent()</a></code> (and <code><a href="../reference/simEvent.html">simEventData()</a></code>), the argument <code>frailty</code> may take a numeric number (vector) as input for specific shared frailty effect for clusters. For instance, we may simulate the recurrent event times for four processes coming from two clusters with shared gamma frailty within cluster, where the first two processes come from one cluster while the remaining two come from another cluster.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co">## shared gamma frailty for processes from two clusters</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>frailtyEffect &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span>(<span class="dv">2</span>, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> <span class="fl">0.5</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">nProcess =</span> <span class="dv">4</span>, <span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>),</span>
<span id="cb40-4"><a href="#cb40-4"></a>             <span class="dt">frailty =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(frailtyEffect, <span class="dt">each =</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##    ID  time event origin  X.1 X.2 X.3
## 1   1 0.572     1      0 1.06   0 0.5
## 2   1 1.625     1      0 1.16   1 0.5
## 3   1 1.947     1      0 1.19   1 0.5
## 4   1 2.345     1      0 1.23   1 0.5
## 5   1 3.000     0      0 1.30   1 0.5
## 6   2 1.695     1      0 1.17   1 0.5
## 7   2 2.776     1      0 1.28   1 0.5
## 8   2 3.000     0      0 1.30   1 0.5
## 9   3 1.702     1      0 1.17   1 0.5
## 10  3 2.876     1      0 1.29   1 0.5
## 11  3 3.000     0      0 1.30   1 0.5
## 12  4 0.276     1      0 1.03   0 0.5
## 13  4 2.443     1      0 1.24   1 0.5
## 14  4 3.000     0      0 1.30   1 0.5</code></pre>
<p>If the length of the specified frailty vector is less than the number of processes, the vector will be recycled internally. In the example given below, the process 1 and process 3 shared a same frailty effect (<code>frailtyEffect[1L]</code>). Similarly, the process 2 and process 4 shared a same frailty effect (<code>frailtyEffect[2L]</code>).</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">nProcess =</span> <span class="dv">4</span>, <span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>),</span>
<span id="cb42-3"><a href="#cb42-3"></a>             <span class="dt">frailty =</span> frailtyEffect)</span></code></pre></div>
<pre><code>##    ID  time event origin  X.1 X.2 X.3
## 1   1 0.956     1      0 1.10   0 0.5
## 2   1 1.851     1      0 1.19   1 0.5
## 3   1 1.873     1      0 1.19   1 0.5
## 4   1 1.910     1      0 1.19   1 0.5
## 5   1 2.124     1      0 1.21   1 0.5
## 6   1 2.335     1      0 1.23   1 0.5
## 7   1 2.433     1      0 1.24   1 0.5
## 8   1 3.000     0      0 1.30   1 0.5
## 9   2 0.315     1      0 1.03   0 0.5
## 10  2 0.472     1      0 1.05   0 0.5
## 11  2 1.181     1      0 1.12   1 0.5
## 12  2 2.486     1      0 1.25   1 0.5
## 13  2 2.886     1      0 1.29   1 0.5
## 14  2 3.000     0      0 1.30   1 0.5
## 15  3 1.000     1      0 1.10   1 0.5
## 16  3 1.908     1      0 1.19   1 0.5
## 17  3 2.695     1      0 1.27   1 0.5
## 18  3 3.000     0      0 1.30   1 0.5
## 19  4 0.499     1      0 1.05   0 0.5
## 20  4 2.308     1      0 1.23   1 0.5
## 21  4 2.731     1      0 1.27   1 0.5
## 22  4 2.948     1      0 1.29   1 0.5
## 23  4 3.000     0      0 1.30   1 0.5</code></pre>
</div>
</div>
<div id="common-parametric-survival-models" class="section level1">
<h1 class="hasAnchor">
<a href="#common-parametric-survival-models" class="anchor"></a>Common parametric survival models</h1>
<p>In this section, we present examples for generating event times with time-invariant covariates for several common parametric survival models.</p>
<div id="weibull-model" class="section level2">
<h2 class="hasAnchor">
<a href="#weibull-model" class="anchor"></a>Weibull model</h2>
<p>The Weibull model is one of the most widely used parametric survival models. Assume the event times of the process <span class="math inline">\(i\)</span>, <span class="math inline">\(i\in\{1,\ldots,n\}\)</span>, follow Weibull model with hazard function <span class="math inline">\(h_i(t) = \lambda_i p t^{p-1}\)</span>, where <span class="math inline">\(p&gt;0\)</span> is the shape parameter, and <span class="math inline">\(\lambda_i\)</span> can be reparametrized with regression coefficients. When <span class="math inline">\(p=1\)</span>, the Weibull model reduces to the exponential model, whose hazard rate is a constant over time.</p>
<p>One common reparametrization is <span class="math inline">\(\lambda_i = \exp(\beta_0 + \boldsymbol{\beta}^{\top}\mathbf{z}_i)\)</span>, which results in Weibull proportional hazard (PH) model. Let <span class="math inline">\(\lambda_0 = \exp(\beta_0)\)</span> and we may rewrite the hazard function <span class="math inline">\(h_i(t) = \rho(t) \exp(\boldsymbol{\beta}^{\top}\mathbf{z}_i)\)</span>, where <span class="math inline">\(\rho(t) = \lambda_0 p t^{p-1}\)</span> is the baseline hazard function. For example, we may simulate the survival data of ten processes from Weibull PH model as follows:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>nProcess &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>rho_weibull_ph &lt;-<span class="st"> </span><span class="cf">function</span>(x, lambda, p) lambda <span class="op">*</span><span class="st"> </span>p <span class="op">*</span><span class="st"> </span>x <span class="op">^</span><span class="st"> </span>(p <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(nProcess), <span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(nProcess, <span class="dv">1</span>, <span class="fl">0.5</span>)),</span>
<span id="cb44-4"><a href="#cb44-4"></a>             <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">0.2</span>), <span class="dt">endTime =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(nProcess, <span class="dv">10</span>),</span>
<span id="cb44-5"><a href="#cb44-5"></a>             <span class="dt">recurrent =</span> <span class="ot">FALSE</span>, <span class="dt">rho =</span> rho_weibull_ph,</span>
<span id="cb44-6"><a href="#cb44-6"></a>             <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">rho =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">lambda =</span> <span class="fl">0.01</span>, <span class="dt">p =</span> <span class="dv">2</span>)))</span></code></pre></div>
<pre><code>##    ID  time event origin    X.1 X.2
## 1   1  7.48     1      0  0.887   1
## 2   2  4.24     1      0 -0.151   1
## 3   3  6.81     1      0  0.330   0
## 4   4 10.59     1      0 -3.227   0
## 5   5  4.73     1      0 -0.772   1
## 6   6 10.28     0      0  0.287   0
## 7   7  6.93     1      0 -1.221   1
## 8   8  4.35     1      0  0.435   0
## 9   9  3.78     1      0  0.800   0
## 10 10  8.93     0      0 -0.164   1</code></pre>
</div>
<div id="gompertz-model" class="section level2">
<h2 class="hasAnchor">
<a href="#gompertz-model" class="anchor"></a>Gompertz model</h2>
<p>The baseline hazard function of the gompertz model is <span class="math inline">\(\rho(t) = \lambda\exp(\alpha t)\)</span>, where <span class="math inline">\(\lambda &gt; 0\)</span> is the scale parameter and <span class="math inline">\(\alpha\)</span> is the shape paramter. So the logrithm of the baseline hazard function is linear in time <span class="math inline">\(t\)</span>.</p>
<p>Similar to the example for the Weibull model given in last section, we may simulate the survival data of ten processes as follows:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>rho_gompertz &lt;-<span class="st"> </span><span class="cf">function</span>(time, lambda, alpha) lambda <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(alpha <span class="op">*</span><span class="st"> </span>time)</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(nProcess), <span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(nProcess, <span class="dv">1</span>, <span class="fl">0.5</span>)),</span>
<span id="cb46-3"><a href="#cb46-3"></a>             <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">0.2</span>), <span class="dt">endTime =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(nProcess, <span class="dv">10</span>),</span>
<span id="cb46-4"><a href="#cb46-4"></a>             <span class="dt">recurrent =</span> <span class="ot">FALSE</span>, <span class="dt">rho =</span> rho_gompertz,</span>
<span id="cb46-5"><a href="#cb46-5"></a>             <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">rho =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">lambda =</span> <span class="fl">0.1</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>)))</span></code></pre></div>
<pre><code>##    ID time event origin    X.1 X.2
## 1   1 8.95     0      0 -1.462   1
## 2   2 8.74     0      0  0.688   0
## 3   3 4.92     1      0  2.100   0
## 4   4 9.43     1      0 -1.287   1
## 5   5 5.41     1      0  0.788   1
## 6   6 3.35     1      0  0.769   0
## 7   7 7.29     1      0  0.332   0
## 8   8 4.48     1      0 -1.008   1
## 9   9 7.40     1      0 -0.119   1
## 10 10 9.78     0      0 -0.280   0</code></pre>
</div>
<div id="log-logistic-model" class="section level2">
<h2 class="hasAnchor">
<a href="#log-logistic-model" class="anchor"></a>Log-logistic model</h2>
<p>As discussed in Section <a href="#accelerated-failure-time-model">accelerated failure time model</a>, the hazard function of the log-logistic model is <span class="math display">\[\lambda(t \mid \mathbf{z}_i) = \frac{p
(t\lambda_{\mathbf{z}})^p/t}{1 + (t\lambda_{\mathbf{z}})^p}.\]</span> So we may simulate the survival data of ten processes from the log-logistic model as follows:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>rho_loglogistic &lt;-<span class="st"> </span><span class="cf">function</span>(time, z, zCoef, p) {</span>
<span id="cb48-2"><a href="#cb48-2"></a>    lambda &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="../reference/parametrize.html">parametrize</a></span>(z, zCoef, <span class="dt">FUN =</span> <span class="st">"exponential"</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a>    lambda <span class="op">*</span><span class="st"> </span>p <span class="op">*</span><span class="st"> </span>(lambda <span class="op">*</span><span class="st"> </span>time) <span class="op">^</span><span class="st"> </span>(p <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(lambda <span class="op">*</span><span class="st"> </span>time) <span class="op">^</span><span class="st"> </span>p)</span>
<span id="cb48-4"><a href="#cb48-4"></a>}</span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dv">1</span>, <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(nProcess), <span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(nProcess, <span class="dv">1</span>, <span class="fl">0.5</span>)),</span>
<span id="cb48-6"><a href="#cb48-6"></a>             <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>), <span class="dt">end =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(nProcess, <span class="dv">10</span>),</span>
<span id="cb48-7"><a href="#cb48-7"></a>             <span class="dt">recurrent =</span> <span class="ot">FALSE</span>, <span class="dt">relativeRisk =</span> <span class="st">"none"</span>, <span class="dt">rho =</span> rho_loglogistic,</span>
<span id="cb48-8"><a href="#cb48-8"></a>             <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">rho =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">p =</span> <span class="fl">1.5</span>)))</span></code></pre></div>
<pre><code>##    ID   time event origin X.1     X.2 X.3
## 1   1  0.206     1      0   1  0.9625   1
## 2   2  1.350     1      0   1  0.6843   0
## 3   3  1.972     1      0   1 -1.3953   1
## 4   4  3.480     1      0   1  0.8496   1
## 5   5  0.834     1      0   1 -0.4466   0
## 6   6 11.054     0      0   1  0.1748   1
## 7   7  0.916     1      0   1  0.0746   1
## 8   8  1.664     1      0   1  0.4282   1
## 9   9  3.238     1      0   1  0.0247   1
## 10 10  0.279     1      0   1 -1.6675   1</code></pre>
<p>Notice that in the function <code>rho_loglogistic()</code> for the hazard function of the log-logistic model, we wrapped the parametrization of the covariates and covariate coefficients with the function <code>parametrize</code> and specified that <code>FUN = "exponential"</code>. In addition, we specified <code>relativeRisk = "none"</code> when calling <code><a href="../reference/simEvent.html">simEventData()</a></code> for AFT models.</p>
</div>
<div id="log-normal-model" class="section level2">
<h2 class="hasAnchor">
<a href="#log-normal-model" class="anchor"></a>Log-normal model</h2>
<p>By following the discussion given in Section <a href="#accelerated-failure-time-model">accelerated failure time model</a>, it is not hard to obtain the hazard function of the log-normal model, <span class="math display">\[\lambda(t \mid \mathbf{z}_i) = \frac{p}{t}
\rho\bigl(p(\log(t) - \boldsymbol{\beta}^{\top}\mathbf{z}_i)\bigr),\]</span> where <span class="math inline">\(\rho(w) = \phi(w) / \bigl(1 - \Phi(w)\bigr)\)</span>, <span class="math inline">\(\phi(w)\)</span> and <span class="math inline">\(\Phi(w)\)</span> is the density and cumulative distribution function of random variable following standard normal distribution.</p>
<p>The example of simulating survival times of ten processes from the log-normal model is given as follows:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>rho_lognormal &lt;-<span class="st"> </span><span class="cf">function</span>(time, z, zCoef, p) {</span>
<span id="cb50-2"><a href="#cb50-2"></a>    foo &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(x) <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(x, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb50-3"><a href="#cb50-3"></a>    alpha &lt;-<span class="st"> </span><span class="kw"><a href="../reference/parametrize.html">parametrize</a></span>(z, zCoef, <span class="dt">FUN =</span> <span class="st">"linear"</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>    w &lt;-<span class="st"> </span>p <span class="op">*</span><span class="st"> </span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(time) <span class="op">-</span><span class="st"> </span>alpha)</span>
<span id="cb50-5"><a href="#cb50-5"></a>    <span class="kw">foo</span>(w) <span class="op">*</span><span class="st"> </span>p <span class="op">/</span><span class="st"> </span>time</span>
<span id="cb50-6"><a href="#cb50-6"></a>}</span>
<span id="cb50-7"><a href="#cb50-7"></a><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dv">1</span>, <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(nProcess), <span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(nProcess, <span class="dv">1</span>, <span class="fl">0.5</span>)),</span>
<span id="cb50-8"><a href="#cb50-8"></a>             <span class="dt">zCoef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>), <span class="dt">end =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(nProcess, <span class="dv">10</span>),</span>
<span id="cb50-9"><a href="#cb50-9"></a>             <span class="dt">recurrent =</span> <span class="ot">FALSE</span>, <span class="dt">relativeRisk =</span> <span class="st">"none"</span>,</span>
<span id="cb50-10"><a href="#cb50-10"></a>             <span class="dt">rho =</span> rho_lognormal, <span class="dt">method =</span> <span class="st">"inversion"</span>,</span>
<span id="cb50-11"><a href="#cb50-11"></a>             <span class="dt">arguments =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">rho =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">p =</span> <span class="fl">0.5</span>)))</span></code></pre></div>
<pre><code>##    ID    time event origin X.1    X.2 X.3
## 1   1  0.0907     1      0   1  0.433   1
## 2   2  3.7646     1      0   1  0.510   0
## 3   3  8.8247     0      0   1  1.196   1
## 4   4  0.1732     1      0   1 -1.084   0
## 5   5  0.2221     1      0   1 -1.145   1
## 6   6  8.8738     0      0   1  0.155   1
## 7   7  2.6047     1      0   1 -0.492   1
## 8   8 10.5684     0      0   1  2.367   1
## 9   9  0.1656     1      0   1 -1.434   1
## 10 10  0.2125     1      0   1 -1.611   0</code></pre>
<p>Notice that the time origin was set to be zero by default. So the time variable <span class="math inline">\(t\)</span> in the denominator of the hazard function <span class="math inline">\(\lambda(t \mid \mathbf{z}_i)\)</span>, may result in undefined value when <span class="math inline">\(t=0\)</span>. Therefore, we specified <code>method = "inversion"</code> for the inversion sampling method for the log-normal model.</p>
</div>
</div>
<div id="reference" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h1>
<div id="refs" class="references">
<div id="ref-aalen2008springer">
<p>Aalen, Odd, Ornulf Borgan, and Hakon Gjessing. 2008. <em>Survival and Event History Analysis: A Process Point of View</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-andersen1982aos">
<p>Andersen, Per Kragh, and Richard David Gill. 1982. “Cox’s Regression Model for Counting Processes: A Large Sample Study.” <em>The Annals of Statistics</em> 10 (4): 1100–1120.</p>
</div>
<div id="ref-cinlar1975printice">
<p>Çınlar, Erhan. 1975. <em>Introduction to Stochastic Processes</em>. Englewood Cliffs, NJ: Printice-Hall.</p>
</div>
<div id="ref-cox1972jrssb">
<p>Cox, David R. 1972. “Regression Models and Life-Tables.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 34 (2): 187–220.</p>
</div>
<div id="ref-crowley1977jasa">
<p>Crowley, John, and Marie Hu. 1977. “Covariance Analysis of Heart Transplant Survival Data.” <em>Journal of the American Statistical Association</em> 72 (357): 27–36.</p>
</div>
<div id="ref-kalbfleisch2002wiley">
<p>Kalbfleisch, John D, and Ross L Prentice. 2002. <em>The Statistical Analysis of Failure Time Data</em>. Vol. 360. John Wiley &amp; Sons.</p>
</div>
<div id="ref-kleinbaum2011springer">
<p>Kleinbaum, D G, and M Klein. 2011. <em>Survival Analysis: A Self-Learning Text</em>. New York: Springer.</p>
</div>
<div id="ref-lewis1979nrlq">
<p>Lewis, P A, and G S Shedler. 1979. “Simulation of Nonhomogeneous Poisson Processes by Thinning.” <em>Naval Research Logistics Quarterly</em> 26 (3): 403–13.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#intro">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#intensity">Intensity function</a></li>
      <li><a href="#sampling-methods">Sampling methods</a></li>
      </ul>
</li>
      <li><a href="#getting-started">Getting started</a></li>
      <li>
<a href="#poisson-process">Poisson process</a><ul class="nav nav-pills nav-stacked">
<li><a href="#hpp">Homogeneous Poisson process</a></li>
      <li><a href="#nhpp">Nonhomogeneous Poisson process</a></li>
      </ul>
</li>
      <li><a href="#renewal-processes">Renewal processes</a></li>
      <li>
<a href="#beyond-time-invariance">Beyond time-invariance</a><ul class="nav nav-pills nav-stacked">
<li><a href="#time-variant-covariates">Time-variant covariates</a></li>
      <li><a href="#time-variant-covariate-coefficients">Time-variant covariate coefficients</a></li>
      </ul>
</li>
      <li>
<a href="#frailty">Frailty models</a><ul class="nav nav-pills nav-stacked">
<li><a href="#individual-frailty">Frailty for individual processes</a></li>
      <li><a href="#shared-frailty">Shared frailty for clusters</a></li>
      </ul>
</li>
      <li>
<a href="#common-parametric-survival-models">Common parametric survival models</a><ul class="nav nav-pills nav-stacked">
<li><a href="#weibull-model">Weibull model</a></li>
      <li><a href="#gompertz-model">Gompertz model</a></li>
      <li><a href="#log-logistic-model">Log-logistic model</a></li>
      <li><a href="#log-normal-model">Log-normal model</a></li>
      </ul>
</li>
      <li><a href="#reference">Reference</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Wenjie Wang, Haoda Fu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
